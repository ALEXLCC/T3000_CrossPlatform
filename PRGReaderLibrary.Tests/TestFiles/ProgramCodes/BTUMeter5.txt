10 REM ****** TEST TIMER ****** 
20 TESTTIM = TIME-OFF ( INIT ) 
30 TESTSEC = TIME-OFF ( INIT ) 
40 REM ******** AMOUNT LEFT TO BE PUMPED ********* 
50 STOPVOL = TESTVOL - SCALETOT 
60 IF ENDTEST THEN STOPVOL = 0 
70 REM ***** READ THE CALIBRATION VALUE FROM THE METER **** 
80 CALIBRD = 19.253.MB_REG101 
90 CALIBERR = ABS ( CALIBRD - CALIBNOW ) 
100 REM ** IF THERE IS A NEW CAL VALUE, WRITE IT ******** 
110 IF CALIBERR >= 1 THEN 19.253.MB_REG101 = CALIBNOW 
120 REM ************************************* 
130 ERRORKG = SCALETOT - METERTOT 
140 REM *** AT THE BEGINNING OF THE TEST ERROR IS LARGE, ZERO IT FOR NOW. 
150 IF METERTOT < 5 THEN ERRORKG = 0 
160 ERRORPCT = ERRORKG / METERTOT * 100 
170 REM *********** SELECT NEXT CALIBRATION FACTOR ********* 
180 CALIBFST = INT ( CALIBRD * ( 100 + ERRORPCT ) / 100 ) 
190 IF ABS ( ERRORPCT ) > 5 THEN CALIBNXT = CALIBFST 
200 IF ABS ( ERRORPCT ) < 5 THEN CALIBNXT = 0.900 * CALIBRD + 0.100 * CALIBFST 
210 IF+ CALFLAG THEN GOTO 220 ELSE GOTO 280 
220 CALIBNOW = CALIBNXT 
230 ACCUR4 = ACCUR3 
240 ACCUR3 = ACCUR2 
250 ACCUR2 = ACCUR1 
260 ACCUR1 = ERRORPCT 
270 STOP CALFLAG 
280 REM ********** END OF THE TEST ****** 
290 IF SCALETOT > TESTVOL THEN START ENDTEST 
300 ENDTIMR = TIME-ON ( ENDTEST ) 
310 IF ENDTIMR > 00:00:40 AND CALIBERR < 1 THEN STOP ENDTEST 
320 REM ******* SHORT DELAY TO LET THE METER READINGS UPDATE BEFORE CALIBRATING 
330 IF+ ENDTIMR > 00:00:20 THEN START CALFLAG 
340 REM *** AFTER ENDTEST SHOWS TRUE THEN INIT THE TEST 
350 IF- ENDTEST THEN START INIT 
360 REM ****************AVG ERROR CALCS ************* 
370 REM THE IDEA HERE IS TO CALCULATE THE AVERAGE ERROR 
380 REM AND USE THAT TO ADJUST THE CALIBRATION VALUES. 
390 IF INTERVAL ( 00:00:01 ) THEN GOTO 400 ELSE GOTO 130 
400 REM XXXXXXX = ( XXXXXXX + ERRORPCT ) / TESTSEC 
410 REM ********************************************* 